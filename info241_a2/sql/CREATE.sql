CREATE TABLE ADMIN (
AID INT PRIMARY KEY IDENTITY,
USERNAME VARCHAR(15),
PASSWORD VARCHAR(15)
);

CREATE TABLE DIFFICULTY(
DIFF CHAR(4) PRIMARY KEY,
DIFFNAME CHAR (4)
);

CREATE TABLE PUZZLE(
PID CHAR(4) PRIMARY KEY,
PNAME CHAR(4),
DIFF CHAR(4),
PBOX1 INT CHECK(PBOX1 IN(1,2,3,4)),
PBOX2 INT CHECK(PBOX2 IN(1,2,3,4)),
PBOX3 INT CHECK(PBOX3 IN(1,2,3,4)),
PBOX4 INT CHECK(PBOX4 IN(1,2,3,4)),
PBOX5 INT CHECK(PBOX5 IN(1,2,3,4)),
PBOX6 INT CHECK(PBOX6 IN(1,2,3,4)),
PBOX7 INT CHECK(PBOX7 IN(1,2,3,4)),
PBOX8 INT CHECK(PBOX8 IN(1,2,3,4)),
PBOX9 INT CHECK(PBOX9 IN(1,2,3,4)),
PBOX10 INT CHECK(PBOX10 IN(1,2,3,4)),
PBOX11 INT CHECK(PBOX11 IN(1,2,3,4)),
PBOX12 INT CHECK(PBOX12 IN(1,2,3,4)),
PBOX13 INT CHECK(PBOX13 IN(1,2,3,4)),
PBOX14 INT CHECK(PBOX14 IN(1,2,3,4)),
PBOX15 INT CHECK(PBOX15 IN(1,2,3,4)),
PBOX16 INT CHECK(PBOX16 IN(1,2,3,4)),
CONSTRAINT FK_DIFF FOREIGN KEY ("DIFF") REFERENCES "DIFFICULTY" ("DIFF"),
CONSTRAINT QUAD1UNIQUE CHECK(PBOX1 != PBOX2 AND PBOX1 != PBOX5 AND PBOX1 != PBOX6 AND PBOX2 != PBOX5 AND PBOX2 != PBOX6 AND PBOX5 != PBOX6),
CONSTRAINT QUAD2UNIQUE CHECK(PBOX3 != PBOX4 AND PBOX3 != PBOX7 AND PBOX3 != PBOX8 AND PBOX4 != PBOX7 AND PBOX4 != PBOX8 AND PBOX7 != PBOX8),
CONSTRAINT QUAD3UNIQUE CHECK(PBOX9 != PBOX10 AND PBOX9 != PBOX13 AND PBOX9 != PBOX14 AND PBOX10 != PBOX13 AND PBOX10 != PBOX14 and PBOX13 != PBOX14),
CONSTRAINT QUAD4UNIQUE CHECK(PBOX11 != PBOX12 AND PBOX11 != PBOX15 AND PBOX11 != PBOX16 AND PBOX12 != PBOX15 AND PBOX12 != PBOX16 AND PBOX15 != PBOX16),
CONSTRAINT HLINE1UNIQUE CHECK(PBOX1 != PBOX2 AND PBOX1 != PBOX3 AND PBOX1 != PBOX4 AND PBOX2 != PBOX3 AND PBOX2 != PBOX4 AND PBOX3 != PBOX4),
CONSTRAINT HLINE2UNIQUE CHECK(PBOX5 != PBOX6 AND PBOX5 != PBOX7 AND PBOX5 != PBOX8 AND PBOX6 != PBOX7 AND PBOX6 != PBOX8 AND PBOX7 != PBOX8),
CONSTRAINT HLINE3UNIQUE CHECK(PBOX9 != PBOX10 AND PBOX9 != PBOX11 AND PBOX9 != PBOX12 AND PBOX10 != PBOX11 AND PBOX10 != PBOX12 AND PBOX11 != PBOX12),
CONSTRAINT HLINE4UNIQUE CHECK(PBOX13 != PBOX14 AND PBOX13 != PBOX15 AND PBOX13 != PBOX16 AND PBOX14 != PBOX15 AND PBOX14 != PBOX16 AND PBOX15 != PBOX16),
CONSTRAINT VLINE1UNIQUE CHECK(PBOX1 != PBOX5 AND PBOX1 != PBOX9 AND PBOX1 != PBOX13 AND PBOX5 != PBOX9 AND PBOX5 != PBOX13 AND PBOX9 != PBOX13),
CONSTRAINT VLINE2UNIQUE CHECK(PBOX2 != PBOX6 AND PBOX2 != PBOX10 AND PBOX2 != PBOX14 AND PBOX6 != PBOX10 AND PBOX6 != PBOX14 AND PBOX10 != PBOX14),
CONSTRAINT VLINE3UNIQUE CHECK(PBOX3 != PBOX7 AND PBOX3 != PBOX11 AND PBOX3 != PBOX15 AND PBOX7 != PBOX11 AND PBOX7 != PBOX15 and PBOX11 != PBOX15),
CONSTRAINT VLINE4UNIQUE CHECK(PBOX4 != PBOX8 AND PBOX4 != PBOX12 AND PBOX4 != PBOX16 AND PBOX8 != PBOX12 AND PBOX8 != PBOX16 AND PBOX12 != PBOX16)
);

CREATE TABLE SOLUTION(
SID CHAR(4) PRIMARY KEY,
PID CHAR(4),
SOLUTION CHAR(16),
CONSTRAINT FK_PID_SOL FOREIGN KEY ("PID") REFERENCES "PUZZLE" ("PID")
);

CREATE TABLE RESULT (
RCODE CHAR(4) PRIMARY KEY,
DATETIME DATETIME,
PID CHAR(4),
CORRECT INT CHECK(CORRECT IN(0,1)),
SOLUTION CHAR(16),
EMAIL VARCHAR(50) NOT NULL,
CLOCKTIME INT,
CONSTRAINT FK_PID_RES FOREIGN KEY ("PID") REFERENCES "PUZZLE" ("PID")
);